<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>오늘 그릴 그림은? | 조약돌 마을</title>
  <!-- Tailwind CDN (무빌드) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* 3D 카드 뒤집기 */
    .scene { perspective: 1200px; }
    .card { transform-style: preserve-3d; transition: transform .8s cubic-bezier(.2,.8,.2,1); }
    .card.is-flipped { transform: rotateY(180deg); }
    .card-face { backface-visibility: hidden; }
    .card-back { transform: rotateY(180deg); }
    /* 보이지 않는 면 완전 숨김 (검은 화면 방지) */
    .hidden-face { opacity: 0; pointer-events: none; }
    .visible-face { opacity: 1; pointer-events: auto; }
  </style>
</head>
<body class="min-h-screen w-full bg-gradient-to-br from-[#0f172a] via-[#111827] to-[#1f2937] text-white flex items-center justify-center p-4">
  <div id="app" class="w-full max-w-lg"></div>

  <script>
    /* ---------- 데이터 (45가지) ---------- */
    const CATEGORIES = ["대화","감정","상황"];
    const SITUATIONS = [
      { id:1,title:"축하하는 대화 상황",category:"대화",examples:["케이크","폭죽","꽃가루","파티모자","'축하해!' 말풍선"] },
      { id:2,title:"위로해주는 대화 상황",category:"대화",examples:["토닥토닥 손","따뜻한 담요","티슈","하트 핫팩","'괜찮아' 말풍선"] },
      { id:3,title:"상담해주는 대화 상황",category:"대화",examples:["노트와 펜","헤드셋","상담소 간판","체크리스트","생각 구름"] },
      { id:4,title:"잔소리하는 상황",category:"대화",examples:["허리에 손","손가락 짚기","호루라기","경고 표지","찌릿 눈썹"] },
      { id:5,title:"애교부리는 상황",category:"감정",examples:["반짝눈","하트 뿅","브이 포즈","볼 콕","달콤 말풍선"] },
      { id:6,title:"웃는 상황",category:"감정",examples:["눈웃음","박장대소","'ㅋㅋ' 말풍선","웃음 눈물","하이파이브"] },
      { id:7,title:"우는 상황",category:"감정",examples:["뚝뚝 눈물","울먹 말풍선","휴지","콧물 방울","빗방울 배경"] },
      { id:8,title:"슬퍼하는 상황",category:"감정",examples:["고개 푹","비구름","회색 배경","작아진 자세","한숨 말풍선"] },
      { id:9,title:"멋쩍어하는 상황(민망)",category:"감정",examples:["뒷머리 긁적","식은땀","볼 발그레","시선 회피","머쓱 표정"] },
      { id:10,title:"부탁하는 상황",category:"대화",examples:["합장 손","반짝 눈빛","'제발~' 말풍선","리본 상자","고개 끄덕"] },
      { id:11,title:"감사하는 상황",category:"대화",examples:["꾸벅 인사","감사 카드","선물 상자","'고마워' 말풍선","꽃다발"] },
      { id:12,title:"마무리 인사하는 상황",category:"대화",examples:["손 흔들기","잘자 모자","문 닫힘","별·달 배경","'안녕~' 말풍선"] },
      { id:13,title:"화내는 상황 (버럭)",category:"감정",examples:["불꽃 눈썹","증기 분출","분노 게이지","빨간 배경","번개 이펙트"] },
      { id:14,title:"놀라는 상황 (헉!)",category:"감정",examples:["동그란 눈","감탄 부호!","점프","머리 곤두섬","'헉' 말풍선"] },
      { id:15,title:"사랑 고백/애정 표현",category:"대화",examples:["하트 눈","쪽! 키스","꽃다발","러브 레터","하트 배경"] },
      { id:16,title:"심심할 때",category:"상황",examples:["하품","탁상시계","볼 긁적","심드렁 표정","틈새 낙서"] },
      { id:17,title:"피곤하거나 지친 상황",category:"상황",examples:["다크서클","커피","눈 반쯤 감김","기지개","zzz 말풍선"] },
      { id:18,title:"득의양양/자랑하는 상황",category:"감정",examples:["선글라스","엄지척","트로피","반짝 효과","자신만만 포즈"] },
      { id:19,title:"장난치는 상황",category:"상황",examples:["메롱","깜짝 상자","장난 종","몰카 카메라","장난 스티커"] },
      { id:20,title:"기다리는 상황 (언제 와?)",category:"상황",examples:["모래시계","시계 응시","문 쳐다봄","발 동동","'언제와?' 말풍선"] },
      { id:21,title:"고민하는 상황 (흠…)",category:"감정",examples:["턱 괴기","물음표","미로","방울땀","저울 아이콘"] },
      { id:22,title:"도망가거나 회피",category:"상황",examples:["먼지 구름","식은땀","숨기","뒤돌아 도망","벽 뒤 훔쳐보기"] },
      { id:23,title:"사과하는 상황",category:"대화",examples:["두 손 모아 사과","사과 카드","'미안해' 말풍선","고개 숙임","작아진 캐릭터"] },
      { id:24,title:"공감/맞장구",category:"대화",examples:["끄덕끄덕","'ㅇㅇ' 말풍선","손뼉 척","싱긋 미소","동그라미 표시"] },
      { id:25,title:"약속/시간 잡기",category:"대화",examples:["달력","시계","체크 아이콘","메신저 말풍선","약속 도장"] },
      { id:26,title:"응원/파이팅",category:"대화",examples:["응원봉/메가폰","'파이팅!'","근육 포즈","깃발","불꽃 효과"] },
      { id:27,title:"칭찬하기",category:"대화",examples:["별 스티커","칭찬 도장","왕관","엄지척","'최고!'"] },
      { id:28,title:"배고픈 상황",category:"상황",examples:["꼬르륵","수저 포크","김나는 음식","침 방울","빈 접시"] },
      { id:29,title:"지각/허둥지둥",category:"상황",examples:["알람 폭발","헐레벌떡","땀방울","넘어진 운동화","'지각!'"] },
      { id:30,title:"선물/서프라이즈",category:"대화",examples:["리본 상자","카드","하트 태그","전달 제스처","폭죽"] },
      { id:31,title:"눈치 보기",category:"감정",examples:["힐끔","점점점","식은땀 한 방울","작아지기","커튼 뒤 힐끔"] },
      { id:32,title:"비밀/쉿",category:"대화",examples:["입에 손가락","지퍼 입","자물쇠","작은 말풍선","어두운 배경"] },
      { id:33,title:"공부/집중",category:"상황",examples:["책 더미","안경","형광펜","스톱워치","'집중!'"] },
      { id:34,title:"운동/다이어트",category:"상황",examples:["아령","줄넘기","물병","땀방울","칼로리 게이지"] },
      { id:35,title:"비 오는 날",category:"상황",examples:["우산","장화","물웅덩이","주룩 선","빗방울"] },
      { id:36,title:"폭염/더위",category:"상황",examples:["부채질","얼음","선풍기","해 모자","더위 게이지"] },
      { id:37,title:"한파/춥다",category:"상황",examples:["목도리","입김","귀마개","눈송이","파르르 떨기"] },
      { id:38,title:"일요일 힐링",category:"상황",examples:["소파","핫초코","담요","노트북","힐링 말풍선"] },
      { id:39,title:"월요일 우울",category:"감정",examples:["알람시계","한숨","초점잃은 눈","커피 대자","'월요병'"] },
      { id:40,title:"쇼핑/결제",category:"상황",examples:["장바구니","카드 결제","택배 박스","세일 태그","영수증"] },
      { id:41,title:"게임 승/패",category:"감정",examples:["트로피","게임패드","별 효과","KO 텍스트","슬픈 이모지"] },
      { id:42,title:"여행/출발",category:"상황",examples:["캐리어","비행기","지도","티켓","사진"] },
      { id:43,title:"건강/병원",category:"상황",examples:["체온계","파스","밴드","약 봉지","'훅' 기침"] },
      { id:44,title:"소소한 행복",category:"감정",examples:["작은 꽃","반짝이","따뜻한 미소","쿠키","하트 점"] },
      { id:45,title:"집중 업무/마감",category:"상황",examples:["타타탁 키보드","마감 타이머","포스트잇","커피 2잔","다크서클"] },
    ];

    /* ---------- 상태 & 유틸 ---------- */
    let flipped=false, current=null;
    let usedIds=[], avoidRepeats=true, activeCats=[...CATEGORIES], history=[];
    const $ = s => document.querySelector(s);
    const toast = (msg)=>{ const el=document.createElement('div'); el.className='fixed top-4 left-1/2 -translate-x-1/2 z-50 rounded-full bg-white text-black px-4 py-2 shadow-lg text-sm'; el.textContent=msg; document.body.appendChild(el); setTimeout(()=>el.remove(),1600); };

    /* ---------- 렌더 ---------- */
    function render(){
      const currentObj = SITUATIONS.find(s=>s.id===current) || null;

      $('#app').innerHTML = `
        <div>
          <header class="mb-4">
            <h1 class="text-2xl sm:text-3xl font-bold tracking-tight">오늘 그릴 그림은?</h1>
            <p class="text-sm text-gray-300/90">카카오톡 이모티콘 주제 랜덤 추천기</p>
          </header>

          <div class="scene relative">
            <div id="card" class="card relative h-64 sm:h-72 w-full">
              <!-- 앞면 -->
              <div class="card-face front absolute inset-0 rounded-3xl shadow-2xl overflow-hidden border border-emerald-300/25 ${flipped?'hidden-face':'visible-face'}">
                <div class="h-full w-full bg-gradient-to-br from-[#cfe8b6] via-[#b9d8a2] to-[#9dc58a] relative flex flex-col items-center justify-center text-emerald-950/90">
                  <div class="absolute inset-0" style="background:
                    radial-gradient(circle at 25% 20%, rgba(255,255,255,.45), transparent 45%),
                    radial-gradient(circle at 80% 10%, rgba(255,255,255,.25), transparent 55%)"></div>
                  <p class="text-[40px] sm:text-[48px] font-extrabold tracking-tight drop-shadow-sm">조약돌 마을</p>
                  <p class="mt-2 text-sm opacity-80">카드를 뒤집어 주제를 확인하세요</p>
                </div>
              </div>
              <!-- 뒷면 -->
              <div class="card-face card-back absolute inset-0 rounded-3xl shadow-2xl overflow-hidden border border-white/10 ${flipped?'visible-face':'hidden-face'}">
                <div class="h-full w-full bg-gradient-to-b from-slate-900/70 to-slate-800/60 backdrop-blur-sm">
                  <div class="h-full w-full flex flex-col items-center justify-center p-6 text-center">
                    ${currentObj ? `
                      <div class="inline-flex items-center gap-2 text-amber-300/90 mb-2">✨ <span class="text-sm">짜잔~ 오늘의 상황</span></div>
                      <h2 class="text-xl sm:text-2xl font-bold leading-snug mb-2">${currentObj.title}</h2>
                      <div class="text-xs uppercase tracking-wide text-gray-300/80 mb-1">${currentObj.category}</div>
                      <div class="text-xs text-gray-300/80 mb-2">그림 요소 추천</div>
                      <div class="flex flex-wrap items-center justify-center gap-2">
                        ${currentObj.examples.map(ex=>`<span class="text-xs rounded-full bg-white/10 border border-white/10 px-3 py-1">${ex}</span>`).join('')}
                      </div>
                    ` : `
                      <p class="text-sm">아직 카드를 뒤집지 않았어요</p>
                      <p class="text-xs text-gray-400">터치/클릭으로 시작!</p>
                    `}
                  </div>
                </div>
              </div>
            </div>
            <button id="btn-flip" class="absolute inset-0 rounded-3xl ring-0 focus:outline-none focus:ring-2 focus:ring-amber-300/60" aria-label="카드 뒤집기"></button>
          </div>

          <div class="mt-4 grid grid-cols-2 gap-2">
            <button id="btn-new" class="flex items-center justify-center gap-2 rounded-xl bg-white/10 hover:bg-white/20 border border-white/10 px-3 py-2 transition">🔀 <span>새 카드</span></button>
            <button id="btn-copy" class="flex items-center justify-center gap-2 rounded-xl bg-white/10 hover:bg-white/20 border border-white/10 px-3 py-2 transition">📋 <span>복사</span></button>
          </div>

          <div class="mt-3 text-xs text-gray-300/80 flex items-center justify-between">
            <span>카테고리: ${activeCats.join(', ')}</span>
            <span>추천 주제는 계속 추가 중!</span>
          </div>
        </div>
      `;

      // 이벤트
      document.getElementById('btn-flip').onclick = () => {
        if (current===null){ drawNew(); flipped=true; }
        else { flipped=!flipped; }
        render();
      };
      document.getElementById('btn-new').onclick = () => { drawNew(); flipped=false; render(); };
      document.getElementById('btn-copy').onclick = async () => {
        const obj = SITUATIONS.find(s=>s.id===current);
        if(!obj) return;
        try{ await navigator.clipboard.writeText(`오늘의 이모티콘 주제: ${obj.title}`); toast('복사했어요!'); }
        catch{ toast('복사 실패'); }
      };
    }

    /* ---------- 추천 로직 ---------- */
    function pool(){
      const list=SITUATIONS.filter(s=> activeCats.includes(s.category));
      return avoidRepeats ? list.filter(s=> !usedIds.includes(s.id)) : list;
    }
    function drawNew(){
      let p=pool();
      if (p.length===0 && avoidRepeats){
        usedIds=[]; p=pool();
      }
      const next=p[Math.floor(Math.random()*p.length)];
      current=next.id;
      usedIds=Array.from(new Set([...usedIds, next.id]));
      history=[{id:next.id,t:Date.now()}, ...history].slice(0,30);
    }

    // 초기 렌더
    render();
  </script>
</body>
</html>
